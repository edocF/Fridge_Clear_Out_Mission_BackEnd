# 食谱重新生成功能测试指南

## 功能概述
在AI食谱详情页面，用户可以点击"重新生成"按钮，调用后端接口重新生成食谱。

## 测试步骤

### 1. 生成初始食谱
1. 打开前端应用
2. 进入AI食谱页面
3. 选择食材和偏好设置
4. 点击生成食谱
5. 进入食谱详情页面

### 2. 测试重新生成功能
1. 在食谱详情页面，找到"重新生成"按钮
2. 点击"重新生成"按钮
3. 观察加载状态和提示信息
4. 检查新生成的食谱内容

### 3. 验证功能特点
- **加载状态**：显示"AI正在重新生成食谱..."
- **成功提示**：显示"食谱重新生成成功"
- **错误处理**：网络错误或API错误时显示相应提示
- **内容更新**：新生成的食谱会替换原有内容

## 技术实现

### 前端实现
- **按钮位置**：食谱详情页面底部
- **API调用**：调用 `/recipe` POST接口
- **参数传递**：食材列表、食谱选项、用户信息
- **状态管理**：loading状态、错误状态、成功状态

### 后端实现
- **接口路径**：`POST /recipe`
- **参数验证**：检查食材列表是否为空
- **AI调用**：调用AI服务生成新食谱
- **用户信息**：获取用户饮食禁忌信息

### 数据流程
1. 前端收集食材和偏好信息
2. 发送POST请求到后端
3. 后端验证参数并调用AI服务
4. AI生成新食谱内容
5. 返回结果给前端
6. 前端更新页面显示

## 错误处理

### 常见错误
1. **网络错误**：显示"网络错误，请检查网络连接"
2. **登录失效**：显示"请先登录"
3. **API错误**：显示后端返回的具体错误信息
4. **食材为空**：显示"食材列表不能为空"

### 重试机制
- 用户可以多次点击重新生成
- 每次生成都是独立的AI调用
- 不会影响原有的食谱内容

## 用户体验

### 视觉反馈
- **按钮样式**：渐变背景，带有阴影效果
- **点击动画**：按钮缩放效果
- **加载动画**：显示加载图标和文字
- **成功提示**：Toast提示成功信息

### 交互设计
- **防重复点击**：loading状态下禁用按钮
- **错误恢复**：错误后可以继续重试
- **状态保持**：保持用户的食材选择和偏好设置

## 测试用例

### 正常流程
1. 选择食材：鸡蛋、西红柿、青菜
2. 设置偏好：均衡、中式、30分钟内
3. 生成食谱
4. 点击重新生成
5. 验证新食谱内容

### 边界情况
1. **单个食材**：只选择一个食材重新生成
2. **大量食材**：选择多个食材重新生成
3. **特殊偏好**：设置特殊饮食偏好重新生成
4. **网络中断**：在网络中断时测试错误处理

### 性能测试
1. **响应时间**：测试重新生成的响应时间
2. **并发请求**：测试多个重新生成请求的处理
3. **内存使用**：测试长时间使用后的内存情况 